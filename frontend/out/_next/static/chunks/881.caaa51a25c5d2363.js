(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[881],{2881:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return O}});var r=t(2156),o=t(9917),s=t(5144),i=t.n(s),c=t(959),a=t(2648),d=t(3182),l=t(1761),u=t(926),m=t(5276),f=t(6045),p=t.n(f),_=t(3045),k=function(e,n){return{all:[].concat((0,_.Z)(n?[]:[{key:"addFriend",label:"Add Friend"}]),[{key:e?"unBlockUser":"blockUser",label:e?"Unblock User":"Block User"}]),friends:[{key:"removeFriend",label:"Remove Friend"}]}},b=t(6701),v=t(4434),y=t(5184);function g(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function w(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?g(Object(t),!0).forEach(function(n){(0,o.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):g(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var O=function(e){var n=e.type,t=e.onClick,o=e.openElement,s=e.index,f=e.isRequested,_=e.setButtonsDisabled,g=e.isBlocked,O=e.user,F=(0,c.useState)(!1),U=F[0],C=F[1],E=(0,c.useRef)(),j=(0,l.I0)(),x=(0,l.v9)(function(e){return e.socket.socket}),R=(0,l.v9)(function(e){return e.user.user}),P=(0,v.Z)().setMessageOptions,D=(0,c.useMemo)(function(){return k(g,f)},[g,f,k]),Z=(0,c.useCallback)(function(e){var n=w({},O).id;_&&_(!0),(0,r.Z)(i().mark(function t(){var r,o,s,c,a;return i().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!O.email){t.next=16;break}if("add"!==e){t.next=8;break}return t.next=4,(0,b.Z)("AddFriend",{id:n});case 4:null!==(o=r=t.sent)&&void 0!==o&&null!==(s=o.AddFriend)&&void 0!==s&&s.email&&(P({message:"Request Sent",type:"success"}),j((0,y.W)(r.AddFriend))),t.next=13;break;case 8:if("remove"!==e){t.next=13;break}return t.next=11,(0,b.Z)("RemoveFriend",{friendId:n});case 11:(r=t.sent).RemoveFriend.token?(a=(0,u.Z)(null===(c=r.RemoveFriend)||void 0===c?void 0:c.token),j((0,y.W)(a)),localStorage.setItem("token",r.RemoveFriend.token),P({message:"Friend Removed",type:"success"})):r=r.RemoveFriend;case 13:r.message?P({message:r.message,type:"error"}):r.errors&&P({message:r.errors[0],type:"error"}),t.next=17;break;case 16:P({message:"add"===e?"Sign in to add friends":"Sign in to remove friends",type:"warning"});case 17:case"end":return t.stop()}},t)}))()},[P,O,j,_,b.Z]),h=(0,c.useCallback)(function(){var e=w({},R||{}).id;x.emit("blockUser",{by:e,user:O.id},function(e){e.email?(P({type:"success",message:"User Blocked"}),j((0,y.W)(e))):"string"==typeof e&&P({type:"warning",message:e})})},[R,x,P]),B=(0,c.useCallback)(function(e){e.stopPropagation(),C(function(e){return!e}),t&&t(O.email)},[O,U,t,C]),S=(0,c.useCallback)(function(){var e=w({},R||{}).id;x.emit("unBlockUser",{by:e,user:O.id},function(e){e.email?(P({type:"success",message:"User Unblocked"}),j((0,y.W)(e))):"string"==typeof e&&P({type:"warning",message:e})})},[R,x,P]),N=(0,c.useCallback)(function(e){var n;null===(n=e.domEvent)||void 0===n||n.stopPropagation(),"addFriend"===e.key?Z("add"):"blockUser"===e.key?h():"removeFriend"===e.key?Z("remove"):"unBlockUser"===e.key&&S()},[h,Z]);return(0,c.useEffect)(function(){o!==O.email&&U&&o&&C(!1)},[o,O,U]),(0,m.t$)(E,function(e){if(o===O.email){var n=document.getElementsByClassName("list_item_actions_dropdown_".concat(s));n[0]&&n[0].contains(e.target)||C(!1)}}),c.createElement("div",{ref:E,className:p().dropdown_main_cont},c.createElement(d.Z,{trigger:["click"],open:U,overlayClassName:"".concat(p().list_item_actions_dropdown," list_item_actions_dropdown_").concat(s),placement:"bottomLeft",menu:{items:"friend"===n?D.friends:D.all,onClick:function(e){return N(w(w({},e),{},{id:O.id}))}}},c.createElement("div",{className:p().list_item_actions_icon,onClick:B},c.createElement(a.I0R,null))))}},6045:function(e){e.exports={dropdown_main_cont:"UserDropdown_dropdown_main_cont___010M",list_item_actions_icon:"UserDropdown_list_item_actions_icon__kDoep",list_item_actions_dropdown:"UserDropdown_list_item_actions_dropdown__xy5eS"}}}]);