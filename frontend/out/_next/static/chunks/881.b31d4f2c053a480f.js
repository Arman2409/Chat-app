(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[881],{2881:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return O}});var r=t(2156),o=t(9917),i=t(5144),s=t.n(i),a=t(959),c=t(2648),u=t(3182),l=t(1761),d=t(926),f=t(5276),m=t(6045),p=t.n(m),b=t(3045),_=function(e,n){return{all:[].concat((0,b.Z)(n?[]:[{key:"addFriend",label:"Add Friend"}]),[{key:e?"unBlockUser":"blockUser",label:e?"Unblock User":"Block User"}]),friends:[{key:"removeFriend",label:"Remove Friend"}]}},k=t(6701),y=t(4434),v=t(5184);function g(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function w(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?g(Object(t),!0).forEach(function(n){(0,o.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):g(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var O=function(e){var n=e.type,t=e.onClick,o=e.openElement,i=e.index,m=e.isRequested,b=e.setButtonsDisabled,g=e.isBlocked,O=e.user,F=(0,a.useState)(!1),U=F[0],E=F[1],j=(0,a.useRef)(),Z=(0,l.I0)(),C=(0,l.v9)(function(e){return e.socket.socket}),S=(0,a.useState)([]),h=S[0],x=S[1],P=(0,l.v9)(function(e){return e.user.user}),R=(0,y.Z)().setMessageOptions,D=(0,a.useCallback)(function(e){var n=w({},O).id;b&&b(!0),(0,r.Z)(s().mark(function t(){var r,o,i,a,c;return s().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!O.email){t.next=16;break}if("add"!==e){t.next=8;break}return t.next=4,(0,k.Z)("AddFriend",{id:n});case 4:null!==(o=r=t.sent)&&void 0!==o&&null!==(i=o.AddFriend)&&void 0!==i&&i.email&&(R({message:"Request Sent",type:"success"}),Z((0,v.W)(r.AddFriend))),t.next=13;break;case 8:if("remove"!==e){t.next=13;break}return t.next=11,(0,k.Z)("RemoveFriend",{friendId:n});case 11:(r=t.sent).RemoveFriend.token?(c=(0,d.Z)(null===(a=r.RemoveFriend)||void 0===a?void 0:a.token),Z((0,v.W)(c)),localStorage.setItem("token",r.RemoveFriend.token),R({message:"Friend Removed",type:"success"})):r=r.RemoveFriend;case 13:r.message?R({message:r.message,type:"error"}):r.errors&&R({message:r.errors[0],type:"error"}),t.next=17;break;case 16:R({message:"add"===e?"Sign in to add friends":"Sign in to remove friends",type:"warning"});case 17:case"end":return t.stop()}},t)}))()},[R,O,Z,b,k.Z]),B=(0,a.useCallback)(function(){var e=w({},P||{}).id;C.emit("blockUser",{by:e,user:O.id},function(e){e.email?(R({type:"success",message:"User Blocked"}),Z((0,v.W)(e))):"string"==typeof e&&R({type:"warning",message:e})})},[P,O,C,R]),A=(0,a.useCallback)(function(e){e.stopPropagation(),E(function(e){return!e}),t&&t(O.email)},[O,U,t,E]),I=(0,a.useCallback)(function(){var e=w({},P||{}).id;C.emit("unBlockUser",{by:e,user:O.id},function(e){e.email?(R({type:"success",message:"User Unblocked"}),Z((0,v.W)(e))):"string"==typeof e&&R({type:"warning",message:e})})},[P,O,C,R]),N=(0,a.useCallback)(function(e){var n;null===(n=e.domEvent)||void 0===n||n.stopPropagation(),"addFriend"===e.key?D("add"):"blockUser"===e.key?B():"removeFriend"===e.key?D("remove"):"unBlockUser"===e.key&&I()},[B,D,I]);return(0,a.useEffect)(function(){o!==O.email&&U&&o&&E(!1)},[o,O,U]),(0,a.useEffect)(function(){var e=_(g,m);x("friend"===n?e.friends:e.all)},[g,m,_,O]),(0,f.t$)(j,function(e){if(o===O.email){var n=document.getElementsByClassName("list_item_actions_dropdown_".concat(i));n[0]&&n[0].contains(e.target)||E(!1)}}),a.createElement("div",{ref:j,className:p().dropdown_main_cont},a.createElement(u.Z,{trigger:["click"],open:U,overlayClassName:"".concat(p().list_item_actions_dropdown," list_item_actions_dropdown_").concat(i),placement:"bottomLeft",menu:{items:h,onClick:function(e){return N(w(w({},e),{},{id:O.id}))}}},a.createElement("div",{className:p().list_item_actions_icon,onClick:A},a.createElement(c.I0R,null))))}},6045:function(e){e.exports={dropdown_main_cont:"UserDropdown_dropdown_main_cont___010M",list_item_actions_icon:"UserDropdown_list_item_actions_icon__kDoep",list_item_actions_dropdown:"UserDropdown_list_item_actions_dropdown__xy5eS"}},9917:function(e,n,t){"use strict";function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}t.d(n,{Z:function(){return r}})},3045:function(e,n,t){"use strict";t.d(n,{Z:function(){return i}});var r=t(2829),o=t(6526);function i(e){return function(e){if(Array.isArray(e))return(0,r.Z)(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||(0,o.Z)(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}}}]);